!function(t){var i={tooltip:{show:!1,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,snap:!0,lines:!1,clickTips:!1,verticalLines:"continuous",onHover:function(t,i){},$compat:!1}};i.tooltipOpts=i.tooltip;var e=function(t){this.tipPosition={x:0,y:0},this.init(t)};e.prototype.init=function(i){function e(t){var e={};e.x=t.pageX,e.y=t.pageY,i.setTooltipPosition(e)}function o(e,o,n){a.clickmode?(t(i.getPlaceholder()).bind("plothover",s),i.hideTooltip(),a.clickmode=!1):(s(e,o,n),a.getDomElement().is(":visible")&&(t(i.getPlaceholder()).unbind("plothover",s),a.clickmode=!0))}function s(e,o,s){var n=function(t,i,e){if(i>e){var o=e;e=i,i=o}return t>=i&&e>=t?!0:!1},p=function(t,i,e,o){return Math.sqrt((e-t)*(e-t)+(o-i)*(o-i))},r=function(t,i,e,o,s,a,n){if(!n||(n=function(t,i,e,o,s,a){if("undefined"!=typeof e)return{x:e,y:i};if("undefined"!=typeof o)return{x:t,y:o};var n,p=-1/((a-o)/(s-e));return{x:n=(s*(t*p-i+o)+e*(t*-p+i-a))/(p*(s-e)+o-a),y:p*n-p*t+i}}(t,i,e,o,s,a),n.x>=Math.min(e,s)&&n.x<=Math.max(e,s)&&n.y>=Math.min(o,a)&&n.y<=Math.max(o,a))){var r=o-a,l=s-e,d=e*a-o*s;return Math.abs(r*t+l*i+d)/Math.sqrt(r*r+l*l)}var x=p(t,i,e,o),c=p(t,i,s,a);return x>c?c:x};if(s)i.showTooltip(s,a.tooltipOptions.snap?s:o);else if(a.plotOptions.series.lines.show&&a.tooltipOptions.lines===!0){var l=a.plotOptions.grid.mouseActiveRadius,d={distance:l+1},x=o;t.each(i.getData(),function(t,e){for(var s,l=[0],c=[-1],f=1,u=e.data.length-1;u>=f;)if(s=Math.floor((f+u)/2),e.data[s][0]<o.x)f=s+1;else{if(!(e.data[s-1][0]>o.x)){l[0]=s-1,c[0]=s,s>=2&&e.data[s-2][0]===e.data[s-1][0]&&n(o.y,e.data[s-2][1],e.data[s-1][1])?(l[1]=s-2,c[1]=s-1):s+1<e.data.length&&e.data[s+1][0]===e.data[s][0]&&n(o.y,e.data[s][1],e.data[s+1][1])?(l[1]=s,c[1]=s+1):(l=l.splice(0,1),c=c.splice(0,1));break}u=s-1}if(-1===c[0])return void i.hideTooltip();for(var y,h,m,v,s=0;s<l.length;s++){m=l[s],v=c[s],y={x:e.data[m][0],y:e.data[m][1]},h={x:e.data[v][0],y:e.data[v][1]};var g=r(e.xaxis.p2c(o.x),e.yaxis.p2c(o.y),e.xaxis.p2c(y.x),e.yaxis.p2c(y.y),e.xaxis.p2c(h.x),e.yaxis.p2c(h.y),!1);if(g<d.distance){var O=p(y.x,y.y,o.x,o.y)<p(o.x,o.y,h.x,h.y)?m:v,b=(e.datapoints.pointsize,new Array(2));b[0]=h.x!==y.x?o.x:h.x,"right"===a.tooltipOptions.verticalLines?b[1]=h.x!==y.x?y.y+(h.y-y.y)*((o.x-y.x)/(h.x-y.x)):h.y:"left"===a.tooltipOptions.verticalLines?b[1]=h.x!==y.x?y.y+(h.y-y.y)*((o.x-y.x)/(h.x-y.x)):y.y:b[1]=h.x!==y.x?y.y+(h.y-y.y)*((o.x-y.x)/(h.x-y.x)):o.y;var P={datapoint:b,dataIndex:O,series:e,seriesIndex:t};d={distance:g,item:P},a.tooltipOptions.snap&&(x={pageX:e.xaxis.p2c(b[0]),pageY:e.yaxis.p2c(b[1])})}}}),d.distance<l+1?i.showTooltip(d.item,x):i.hideTooltip()}else i.hideTooltip()}var a=this,n=t.plot.plugins.length;if(this.plotPlugins=[],n)for(var p=0;n>p;p++)this.plotPlugins.push(t.plot.plugins[p].name);i.hooks.bindEvents.push(function(i,n){if(a.plotOptions=i.getOptions(),"boolean"==typeof a.plotOptions.tooltip&&(a.plotOptions.tooltipOpts.show=a.plotOptions.tooltip,a.plotOptions.tooltip=a.plotOptions.tooltipOpts,delete a.plotOptions.tooltipOpts),a.plotOptions.tooltip.show!==!1&&"undefined"!=typeof a.plotOptions.tooltip.show){a.tooltipOptions=a.plotOptions.tooltip,a.tooltipOptions.$compat?(a.wfunc="width",a.hfunc="height"):(a.wfunc="innerWidth",a.hfunc="innerHeight");a.getDomElement();t(i.getPlaceholder()).bind("plothover",s),a.tooltipOptions.clickTips&&t(i.getPlaceholder()).bind("plotclick",o),a.clickmode=!1,t(n).bind("mousemove",e)}}),i.hooks.shutdown.push(function(i,a){t(i.getPlaceholder()).unbind("plothover",s),t(i.getPlaceholder()).unbind("plotclick",o),i.removeTooltip(),t(a).unbind("mousemove",e)}),i.setTooltipPosition=function(i){var e=a.getDomElement(),o=e.outerWidth()+a.tooltipOptions.shifts.x,s=e.outerHeight()+a.tooltipOptions.shifts.y;i.x-t(window).scrollLeft()>t(window)[a.wfunc]()-o&&(i.x-=o,i.x=Math.max(i.x,0)),i.y-t(window).scrollTop()>t(window)[a.hfunc]()-s&&(i.y-=s),isNaN(i.x)?a.tipPosition.x=a.tipPosition.xPrev:(a.tipPosition.x=i.x,a.tipPosition.xPrev=i.x),isNaN(i.y)?a.tipPosition.y=a.tipPosition.yPrev:(a.tipPosition.y=i.y,a.tipPosition.yPrev=i.y)},i.showTooltip=function(t,e,o){var s=a.getDomElement(),n=a.stringFormat(a.tooltipOptions.content,t);""!==n&&(s.html(n),i.setTooltipPosition({x:a.tipPosition.x,y:a.tipPosition.y}),s.css({left:a.tipPosition.x+a.tooltipOptions.shifts.x,top:a.tipPosition.y+a.tooltipOptions.shifts.y}).show(),"function"==typeof a.tooltipOptions.onHover&&a.tooltipOptions.onHover(t,s))},i.hideTooltip=function(){a.getDomElement().hide().html("")},i.removeTooltip=function(){a.getDomElement().remove()}},e.prototype.getDomElement=function(){var i=t("<div>");return this.tooltipOptions&&this.tooltipOptions.cssClass&&(i=t("."+this.tooltipOptions.cssClass),0===i.length&&(i=t("<div />").addClass(this.tooltipOptions.cssClass),i.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&i.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"}))),i},e.prototype.stringFormat=function(t,i){var e,o,s,a,n,p=/%p\.{0,1}(\d{0,})/,r=/%s/,l=/%c/,d=/%lx/,x=/%ly/,c=/%x\.{0,1}(\d{0,})/,f=/%y\.{0,1}(\d{0,})/,u=/%X\.{0,1}(\d{0,})/,y=/%Y\.{0,1}(\d{0,})/,h="%x",m="%y",v="%X",g="%Y",O="%ct",b="%n",P=i.datapoint[0],T=i.datapoint[1];if("undefined"!=typeof i.series.threshold?(e=i.datapoint[0],o=i.datapoint[1],s=i.datapoint[2]):"undefined"!=typeof i.series.curvedLines?(e=i.datapoint[0],o=i.datapoint[1]):"undefined"!=typeof i.series.lines&&i.series.lines.steps?(e=i.series.datapoints.points[2*i.dataIndex],o=i.series.datapoints.points[2*i.dataIndex+1],s=""):(e=i.series.data[i.dataIndex][0],o=i.series.data[i.dataIndex][1],s=i.series.data[i.dataIndex][2]),null===i.series.label&&i.series.originSeries&&(i.series.label=i.series.originSeries.label),"function"==typeof t&&(t=t(i.series.label,e,o,i)),"boolean"==typeof t&&!t)return"";if(s&&(t=t.replace(O,s)),"undefined"!=typeof i.series.percent?a=i.series.percent:"undefined"!=typeof i.series.percents&&(a=i.series.percents[i.dataIndex]),"number"==typeof a&&(t=this.adjustValPrecision(p,t,a)),i.series.hasOwnProperty("pie")&&"undefined"!=typeof i.series.data[0][1]&&(n=i.series.data[0][1]),"number"==typeof n&&(t=t.replace(b,n)),t="undefined"!=typeof i.series.label?t.replace(r,i.series.label):t.replace(r,""),t="undefined"!=typeof i.series.color?t.replace(l,i.series.color):t.replace(l,""),t=this.hasAxisLabel("xaxis",i)?t.replace(d,i.series.xaxis.options.axisLabel):t.replace(d,""),t=this.hasAxisLabel("yaxis",i)?t.replace(x,i.series.yaxis.options.axisLabel):t.replace(x,""),this.isTimeMode("xaxis",i)&&this.isXDateFormat(i)&&(t=t.replace(c,this.timestampToDate(e,this.tooltipOptions.xDateFormat,i.series.xaxis.options)),t=t.replace(u,this.timestampToDate(P,this.tooltipOptions.xDateFormat,i.series.xaxis.options))),this.isTimeMode("yaxis",i)&&this.isYDateFormat(i)&&(t=t.replace(f,this.timestampToDate(o,this.tooltipOptions.yDateFormat,i.series.yaxis.options)),t=t.replace(y,this.timestampToDate(T,this.tooltipOptions.yDateFormat,i.series.yaxis.options))),"number"==typeof e&&(t=this.adjustValPrecision(c,t,e),t=this.adjustValPrecision(u,t,P)),"number"==typeof o&&(t=this.adjustValPrecision(f,t,o),t=this.adjustValPrecision(y,t,T)),"undefined"!=typeof i.series.xaxis.ticks){var k;k=this.hasRotatedXAxisTicks(i)?"rotatedTicks":"ticks";var w=i.dataIndex+i.seriesIndex;for(var D in i.series.xaxis[k])if(i.series.xaxis[k].hasOwnProperty(w)&&!this.isTimeMode("xaxis",i)){var $=this.isCategoriesMode("xaxis",i)?i.series.xaxis[k][w].label:i.series.xaxis[k][w].v;$===e&&(t=t.replace(c,i.series.xaxis[k][w].label.replace(/\$/g,"$$$$")))}}if("undefined"!=typeof i.series.yaxis.ticks)for(var F in i.series.yaxis.ticks)if(i.series.yaxis.ticks.hasOwnProperty(F)){var M=this.isCategoriesMode("yaxis",i)?i.series.yaxis.ticks[F].label:i.series.yaxis.ticks[F].v;M===o&&(t=t.replace(f,i.series.yaxis.ticks[F].label.replace(/\$/g,"$$$$")))}return"undefined"!=typeof i.series.xaxis.tickFormatter&&(t=t.replace(h,i.series.xaxis.tickFormatter(e,i.series.xaxis).replace(/\$/g,"$$")),t=t.replace(v,i.series.xaxis.tickFormatter(P,i.series.xaxis).replace(/\$/g,"$$"))),"undefined"!=typeof i.series.yaxis.tickFormatter&&(t=t.replace(m,i.series.yaxis.tickFormatter(o,i.series.yaxis).replace(/\$/g,"$$")),t=t.replace(g,i.series.yaxis.tickFormatter(T,i.series.yaxis).replace(/\$/g,"$$"))),t},e.prototype.isTimeMode=function(t,i){return"undefined"!=typeof i.series[t].options.mode&&"time"===i.series[t].options.mode},e.prototype.isXDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},e.prototype.isYDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},e.prototype.isCategoriesMode=function(t,i){return"undefined"!=typeof i.series[t].options.mode&&"categories"===i.series[t].options.mode},e.prototype.timestampToDate=function(i,e,o){var s=t.plot.dateGenerator(i,o);return t.plot.formatDate(s,e,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},e.prototype.adjustValPrecision=function(t,i,e){var o,s=i.match(t);return null!==s&&""!==RegExp.$1&&(o=RegExp.$1,e=e.toFixed(o),i=i.replace(t,e)),i},e.prototype.hasAxisLabel=function(i,e){return-1!==t.inArray("axisLabels",this.plotPlugins)&&"undefined"!=typeof e.series[i].options.axisLabel&&e.series[i].options.axisLabel.length>0},e.prototype.hasRotatedXAxisTicks=function(i){return-1!==t.inArray("tickRotor",this.plotPlugins)&&"undefined"!=typeof i.series.xaxis.rotatedTicks};var o=function(t){new e(t)};t.plot.plugins.push({init:o,options:i,name:"tooltip",version:"0.9.1"})}(jQuery);
